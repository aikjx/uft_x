# ğŸ”§ å…¬å¼æ¸²æŸ“ä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°

å…¬å¼æ˜¾ç¤º"âš ï¸å…¬å¼æ¸²æŸ“å¤±è´¥ é‡è¯•"ï¼Œæ— æ³•æ­£ç¡®æ¸²æŸ“æ•°å­¦ç¬¦å·ã€‚

### é”™è¯¯ç¤ºä¾‹
```
æ—¶ç©ºåŒä¸€åŒ–æ–¹ç¨‹
âš ï¸å…¬å¼æ¸²æŸ“å¤±è´¥ é‡è¯•
æè¿°æ—¶ç©ºçš„ç»Ÿä¸€æ€§ï¼Œå°†æ—¶é—´ä¸ç©ºé—´åæ ‡ç»Ÿä¸€è¡¨ç¤º
```

---

## ä¿®å¤æ–¹æ¡ˆ

### 1. ç®€åŒ– MathFormula ç»„ä»¶

**é—®é¢˜åŸå› **:
- åŸç»„ä»¶é€»è¾‘è¿‡äºå¤æ‚
- å…¬å¼æ ¼å¼å¤„ç†æœ‰é—®é¢˜
- MathJax è°ƒç”¨æ–¹å¼ä¸æ­£ç¡®

**ä¿®å¤å†…å®¹**:
- âœ… ç®€åŒ–ç»„ä»¶é€»è¾‘
- âœ… æ”¹è¿›å…¬å¼æ¸…ç†å‡½æ•°
- âœ… ä¼˜åŒ– MathJax è°ƒç”¨
- âœ… æ·»åŠ  MathJax åŠ è½½ç­‰å¾…
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†

### 2. æ ¸å¿ƒæ”¹è¿›

#### å…¬å¼æ¸…ç†
```typescript
const cleanFormula = (text: string): string => {
  if (!text) return ''
  
  // ç§»é™¤é¦–å°¾çš„ $ ç¬¦å·
  let cleaned = text.trim()
    .replace(/^\$\$|\$\$$/g, '')
    .replace(/^\$|\$$/g, '')
    .replace(/^\\\[|\\\]$/g, '')
    .replace(/^\\\(|\\\)$/g, '')
  
  // è½¬æ¢å‘é‡ç¬¦å·
  cleaned = cleaned.replace(/\\vec\{([^}]+)\}/g, '\\overrightarrow{$1}')
  
  return cleaned
}
```

#### MathJax æ¸²æŸ“
```typescript
// ç­‰å¾… MathJax åŠ è½½
if (!window.MathJax) {
  let attempts = 0
  while (!window.MathJax && attempts < 10) {
    await new Promise(resolve => setTimeout(resolve, 500))
    attempts++
  }
}

// è®¾ç½®å…¬å¼å†…å®¹
const delimiter = props.inline ? '\\(' : '\\['
const endDelimiter = props.inline ? '\\)' : '\\]'
formulaElement.value.textContent = `${delimiter}${cleaned}${endDelimiter}`

// æ¸²æŸ“
await window.MathJax.typesetPromise([formulaElement.value])
```

---

## æµ‹è¯•æ­¥éª¤

### 1. é‡å¯å¼€å‘æœåŠ¡å™¨
```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨ (Ctrl+C)
pnpm dev
```

### 2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
- Windows: `Ctrl + Shift + R`
- Mac: `Cmd + Shift + R`

### 3. è®¿é—®å…¬å¼é¡µé¢
```
http://localhost:52025/formulas
```

### 4. æ£€æŸ¥å…¬å¼æ¸²æŸ“

#### é¢„æœŸæ•ˆæœ
```
æ—¶ç©ºåŒä¸€åŒ–æ–¹ç¨‹
râƒ—(t) = Câƒ—t = xÄ±âƒ— + yÈ·âƒ— + zkâƒ—
æè¿°æ—¶ç©ºçš„ç»Ÿä¸€æ€§ï¼Œå°†æ—¶é—´ä¸ç©ºé—´åæ ‡ç»Ÿä¸€è¡¨ç¤º
```

#### æ£€æŸ¥é¡¹
- [ ] å…¬å¼æ˜¾ç¤ºä¸ºæ•°å­¦ç¬¦å·ï¼ˆä¸æ˜¯çº¯æ–‡æœ¬ï¼‰
- [ ] å‘é‡ç¬¦å·æœ‰ç®­å¤´ï¼ˆrâƒ— è€Œä¸æ˜¯ vec{r}ï¼‰
- [ ] ç­‰å·ã€åŠ å·ç­‰ç¬¦å·æ­£ç¡®æ˜¾ç¤º
- [ ] æ²¡æœ‰"å…¬å¼æ¸²æŸ“å¤±è´¥"é”™è¯¯
- [ ] å…¬å¼æ ¼å¼ç¾è§‚

---

## è°ƒè¯•æ–¹æ³•

### 1. æ£€æŸ¥ MathJax åŠ è½½
æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12)ï¼š
```javascript
console.log('MathJax:', window.MathJax)
console.log('MathJax version:', window.MathJax?.version)
```

**é¢„æœŸè¾“å‡º**:
```
MathJax: {version: "3.2.2", ...}
MathJax version: 3.2.2
```

**å¦‚æœæ˜¯ undefined**:
- MathJax CDN å¯èƒ½è¢«å±è”½
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹ç½‘ç»œé¢æ¿ (F12 -> Network)

### 2. æ£€æŸ¥å…¬å¼å…ƒç´ 
```javascript
document.querySelectorAll('.math-formula').forEach(el => {
  console.log('Formula:', el.textContent)
  console.log('Has error:', el.querySelector('.formula-error'))
})
```

### 3. æ‰‹åŠ¨è§¦å‘æ¸²æŸ“
```javascript
if (window.MathJax) {
  window.MathJax.typesetPromise().then(() => {
    console.log('æ¸²æŸ“å®Œæˆ')
  }).catch(err => {
    console.error('æ¸²æŸ“å¤±è´¥:', err)
  })
}
```

---

## å¸¸è§é—®é¢˜

### Q1: å…¬å¼ä»ç„¶æ˜¾ç¤º"æ¸²æŸ“å¤±è´¥"
**åŸå› **: MathJax æœªåŠ è½½æˆ–åŠ è½½å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æµ‹è¯• CDN æ˜¯å¦å¯è®¿é—®:
```bash
curl -I https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js
```
3. å¦‚æœæ— æ³•è®¿é—®ï¼Œä½¿ç”¨å¤‡ç”¨ CDN

### Q2: å…¬å¼æ˜¾ç¤ºä¸ºçº¯æ–‡æœ¬
**åŸå› **: MathJax æ¸²æŸ“æœªæ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ**:
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. é‡å¯å¼€å‘æœåŠ¡å™¨
3. æ£€æŸ¥æ§åˆ¶å°é”™è¯¯

### Q3: å‘é‡ç¬¦å·æ²¡æœ‰ç®­å¤´
**åŸå› **: `\vec` å‘½ä»¤æœªè½¬æ¢

**è§£å†³æ–¹æ¡ˆ**:
- ç»„ä»¶å·²è‡ªåŠ¨è½¬æ¢ `\vec` ä¸º `\overrightarrow`
- å¦‚æœä»ç„¶æœ‰é—®é¢˜ï¼Œæ£€æŸ¥å…¬å¼æºæ•°æ®

### Q4: å…¬å¼æ ¼å¼é”™ä¹±
**åŸå› **: å…¬å¼è¯­æ³•é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥å…¬å¼è¯­æ³•æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿æ‹¬å·åŒ¹é…
3. æ£€æŸ¥ç‰¹æ®Šå­—ç¬¦æ˜¯å¦è½¬ä¹‰

---

## å¤‡ç”¨æ–¹æ¡ˆ

### æ–¹æ¡ˆA: ä½¿ç”¨å¤‡ç”¨ CDN

å¦‚æœ jsdelivr CDN æ— æ³•è®¿é—®ï¼Œåœ¨ `index.html` ä¸­æ›¿æ¢ï¼š

```html
<!-- åŸ CDN -->
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<!-- å¤‡ç”¨ CDN 1: cdnjs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-svg.js"></script>

<!-- å¤‡ç”¨ CDN 2: unpkg -->
<script src="https://unpkg.com/mathjax@3/es5/tex-svg.js"></script>
```

### æ–¹æ¡ˆB: ä½¿ç”¨æœ¬åœ° MathJax

```bash
# å®‰è£…æœ¬åœ° MathJax
pnpm add mathjax@3
```

ç„¶ååœ¨ `src/main.ts` ä¸­å¯¼å…¥ï¼š
```typescript
import 'mathjax/es5/tex-svg.js'
```

### æ–¹æ¡ˆC: é™çº§æ˜¾ç¤º

å¦‚æœ MathJax å®Œå…¨æ— æ³•ä½¿ç”¨ï¼Œå¯ä»¥æ˜¾ç¤º LaTeX æºä»£ç ï¼š

```vue
<template>
  <div class="formula-fallback">
    <code>{{ formula }}</code>
  </div>
</template>
```

---

## éªŒè¯æ¸…å•

### âœ… åŸºæœ¬åŠŸèƒ½
- [ ] å…¬å¼å¯ä»¥æ­£å¸¸æ¸²æŸ“
- [ ] æ²¡æœ‰"æ¸²æŸ“å¤±è´¥"é”™è¯¯
- [ ] æ•°å­¦ç¬¦å·æ˜¾ç¤ºæ­£ç¡®

### âœ… ç‰¹æ®Šç¬¦å·
- [ ] å‘é‡ç¬¦å·æœ‰ç®­å¤´ (râƒ—)
- [ ] å¸Œè…Šå­—æ¯æ­£ç¡®æ˜¾ç¤º (Î±, Î², Î³)
- [ ] åˆ†æ•°æ­£ç¡®æ˜¾ç¤º
- [ ] ä¸Šä¸‹æ ‡æ­£ç¡®æ˜¾ç¤º

### âœ… äº¤äº’åŠŸèƒ½
- [ ] ç‚¹å‡»å…¬å¼å¯ä»¥æŸ¥çœ‹è¯¦æƒ…
- [ ] é‡è¯•æŒ‰é’®å¯ä»¥å·¥ä½œ
- [ ] æ‚¬åœæœ‰é«˜äº®æ•ˆæœ

### âœ… å“åº”å¼
- [ ] æ¡Œé¢ç«¯æ˜¾ç¤ºæ­£å¸¸
- [ ] ç§»åŠ¨ç«¯æ˜¾ç¤ºæ­£å¸¸
- [ ] ä¸åŒå°ºå¯¸ä¸‹æ ¼å¼æ­£ç¡®

---

## æ€§èƒ½ä¼˜åŒ–

### 1. å»¶è¿Ÿæ¸²æŸ“
```typescript
// å»¶è¿Ÿ 100ms æ¸²æŸ“ï¼Œç¡®ä¿ MathJax å·²åŠ è½½
setTimeout(() => {
  renderFormula()
}, 100)
```

### 2. æ‰¹é‡æ¸²æŸ“
```typescript
// ä¸€æ¬¡æ¸²æŸ“å¤šä¸ªå…¬å¼
await window.MathJax.typesetPromise(elements)
```

### 3. ç¼“å­˜æ¸…ç†
```typescript
// ç»„ä»¶å¸è½½æ—¶æ¸…ç†
onBeforeUnmount(() => {
  if (window.MathJax?.typesetClear) {
    window.MathJax.typesetClear([formulaElement.value])
  }
})
```

---

## é¢„æœŸæ•ˆæœ

### ä¿®å¤å‰ âŒ
```
æ—¶ç©ºåŒä¸€åŒ–æ–¹ç¨‹
âš ï¸å…¬å¼æ¸²æŸ“å¤±è´¥ é‡è¯•
æè¿°æ—¶ç©ºçš„ç»Ÿä¸€æ€§
```

### ä¿®å¤å âœ…
```
æ—¶ç©ºåŒä¸€åŒ–æ–¹ç¨‹
râƒ—(t) = Câƒ—t = xÄ±âƒ— + yÈ·âƒ— + zkâƒ—
æè¿°æ—¶ç©ºçš„ç»Ÿä¸€æ€§ï¼Œå°†æ—¶é—´ä¸ç©ºé—´åæ ‡ç»Ÿä¸€è¡¨ç¤º
```

---

## æŠ€æœ¯ç»†èŠ‚

### MathJax é…ç½®
åœ¨ `index.html` ä¸­çš„é…ç½®ï¼š
```javascript
window.MathJax = {
  tex: {
    inlineMath: [['\\(', '\\)']],
    displayMath: [['\\[', '\\]']],
    macros: {
      vec: ['\\overrightarrow{#1}', 1]
    }
  },
  svg: {
    scale: 1.2
  }
}
```

### å…¬å¼åˆ†éš”ç¬¦
- å†…è”å…¬å¼: `\(...\)`
- å—çº§å…¬å¼: `\[...\]`

### å‘é‡ç¬¦å·
- è¾“å…¥: `\vec{r}`
- è½¬æ¢: `\overrightarrow{r}`
- æ˜¾ç¤º: râƒ—

---

**ä¿®å¤å®Œæˆï¼ç«‹å³æµ‹è¯•ï¼** ğŸš€

**æµ‹è¯•åœ°å€**: http://localhost:52025/formulas

**é¢„æœŸç»“æœ**: æ‰€æœ‰å…¬å¼æ­£ç¡®æ¸²æŸ“ï¼Œæ˜¾ç¤ºä¸ºæ•°å­¦ç¬¦å·ã€‚
